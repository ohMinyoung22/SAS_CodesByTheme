PROC IMPORT DATAFILE = '/home/u62429465/codes/SampleData.xlsx'
	DBMS = xlsx REPlACE
	OUT = DATA;
	GETNAMES = YES;
	SHEET = "SalesOrders";
	DATAROW = 10;
	
	
DATA SUB1;
SET DATA (KEEP = OrderDate Region);
ID = _N_;
RUN;

DATA SUB2;
SET DATA (KEEP = Rep Item);
ID = _N_;
IF 10 <= ID <= 20;
RUN;

DATA SUB3_1;
SET DATA;
ID = _N_;
IF 1 <= ID <= 20;
RUN;

DATA SUB3_2;
SET DATA;
ID = _N_;
IF 1 <= ID <= 20 THEN DELETE;
RUN;

/* 수직 결합 */


DATA COMBINE_VERTICAL;
SET SUB3_2 SUB3_1;
RUN;


/* 수평 결합 */
PROC SORT DATA = SUB3_1;
BY ID;
RUN;

PROC SORT DATA = SUB3_2;
BY ID;
RUN;

DATA MERGED_INTERSECTION MERGED_UNION;
MERGE SUB1(IN = S1) SUB2(IN = S2);
IF S1 = 1 AND S2 =1 THEN OUTPUT MERGED_INTERSECTION;
IF S1 = 1 OR S2 = 1 THEN OUTPUT MERGED_UNION;
BY ID;
RUN;

PROC PRINT DATA = MERGED_INTERSECTION;
RUN;

PROC PRINT DATA = MERGED_UNION;
RUN;




